<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard | Sparkam AI</title>
    <script src="brain-core.js"></script>
    <script src="promotion-engine.js"></script>
</head>
<body style="background: #000; color: #fff; font-family: sans-serif; padding: 20px;">
    <h1 style="color: #00ff41;">AI Command Center</h1>
    <div id="campaign-list"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const listEl = document.getElementById('campaign-list');
            // Safety: Ensure memory and tracks exist before reading
            const tracks = (MusicAIBrain.memory && MusicAIBrain.memory.tracks) ? MusicAIBrain.memory.tracks : [];

            if (tracks.length === 0) {
                listEl.innerHTML = "<h2>No tracks analyzed. Go to Studio!</h2>";
                return;
            }

            listEl.innerHTML = "<h2 style='border-left: 4px solid #00ff41; padding-left: 10px;'>Active Campaigns</h2>";
            
            tracks.slice().reverse().forEach(track => {
                const campaign = PromotionEngine.generateCampaign(track);
                
                // Safety Fix: Fallback if scheduledDate or Time is missing
                const dateVal = track.scheduledDate || "Deployment Ready";
                const timeVal = track.scheduledTime || "";

                const card = document.createElement('div');
                card.style.cssText = "background: #111; padding: 20px; border-radius: 10px; border-left: 5px solid #00ff41; margin-bottom: 20px; border: 1px solid #222;";
                card.innerHTML = `
                    <h3 style="color: #00ff41; margin: 0;">${track.name}</h3>
                    <p style="color: #ffaa00; font-weight: bold; font-size: 0.85rem; margin: 10px 0;">ðŸ“… RELEASE: ${dateVal} ${timeVal}</p>
                    <div style="background: #000; padding: 12px; border-radius: 5px; margin-bottom: 15px;">
                        <p style="margin: 0; color: #ccc; font-style: italic;">"${campaign.postContent}"</p>
                    </div>
                    <button onclick="window.location.href='fan-link.html?track=${encodeURIComponent(track.name)}'" style="background: #00ff41; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">View Fan-Link</button>
                `;
                listEl.appendChild(card);
            });
        });
    </script>
</body>
</html>
