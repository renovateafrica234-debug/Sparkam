<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dashboard | Sparkam AI</title>
    <script src="brain-core.js"></script>
    <script src="promotion-engine.js"></script>
</head>
<body style="background: #000; color: #fff; font-family: sans-serif; padding: 20px;">
    <h1>AI Command Center</h1>
    <div id="campaign-list"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const listEl = document.getElementById('campaign-list');
            const tracks = MusicAIBrain.memory.tracks || [];

            if (tracks.length === 0) {
                listEl.innerHTML = "<h2>No tracks found. Go to Studio!</h2>";
                return;
            }

            listEl.innerHTML = "<h2>Active Campaigns</h2>";
            tracks.slice().reverse().forEach(track => {
                const campaign = PromotionEngine.generateCampaign(track);
                
                // CRITICAL FIX: If scheduledDate is missing, don't crash, show fallback
                const dateText = track.scheduledDate ? `${track.scheduledDate} @ ${track.scheduledTime}` : "Analysis Pending";

                const card = document.createElement('div');
                card.style.cssText = "background: #111; padding: 20px; border-radius: 10px; border-left: 5px solid #00ff41; margin-bottom: 20px;";
                card.innerHTML = `
                    <h3 style="color: #00ff41; margin: 0;">${track.name}</h3>
                    <p style="color: #ffaa00; font-weight: bold; font-size: 0.8rem;">ðŸ“… RELEASE: ${dateText}</p>
                    <p style="background: #000; padding: 10px; border: 1px solid #222; border-radius: 5px;">${campaign.postContent}</p>
                    <button onclick="window.location.href='fan-link.html?track=${encodeURIComponent(track.name)}'" style="background: #00ff41; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;">View Fan-Link</button>
                `;
                listEl.appendChild(card);
            });
        });
    </script>
</body>
</html>
